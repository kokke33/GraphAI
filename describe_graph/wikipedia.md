# :star:wikipedia.yaml

このグラフは、サム・バンクマン・フリードに対する裁判所の最終判決についての情報を取得し、処理するためのワークフローを示しています。以下に各ノードの役割を説明します。

1. **sourceノード**:
   - ユーザーからの情報を格納します。ここでは、サム・バンクマン・フリードの名前、トピック（裁判所の文）、およびクエリが含まれています。

2. **wikipediaノード**:
   - `wikipediaAgent`を使用して、Wikipediaからサム・バンクマン・フリードに関するデータを取得します。ノードが実行される前にコンソールにメッセージを表示します。

3. **chunksノード**:
   - 取得したWikipediaの記事をチャンクに分割します。これも、処理前にメッセージを表示します。

4. **embeddingsノード**:
   - 分割されたテキストチャンクの埋め込みを取得します。この処理の前にもメッセージが表示されます。

5. **topicEmbeddingノード**:
   - ユーザーが指定したトピックに対する埋め込みを取得します。

6. **similarityCheckノード**:
   - 埋め込みの類似性を確認します。具体的には、チャンクの埋め込み行列とトピックの埋め込みベクトルのドット積を計算します。

7. **sortedChunksノード**:
   - 類似性に基づいて、チャンクをソートします。

8. **referenceTextノード**:
   - ソートされたチャンクから参照テキストを生成します。ここでは、最大5000トークンまで取得します。

9. **promptノード**:
   - ユーザーのクエリと参照テキストを組み合わせ、最終的なプロンプトを作成します。

10. **RagQueryノード**:
    - RAG（Retrieval-Augmented Generation）クエリを実行し、得られたプロンプトを使用してOpenAIエージェントに問い合わせます。

11. **OneShotQueryノード**:
    - ユーザーのクエリを直接OpenAIエージェントに送信します。

12. **RagResultノード**:
    - RAGクエリの結果をコピーし、最終的な結果としてマークします。

13. **OneShotResultノード**:
    - One Shotクエリの結果をコピーし、こちらも最終的な結果としてマークします。

このグラフは、サム・バンクマン・フリードに関する裁判所の判決を効率的に取得し、ユーザーの質問に対する応答を生成するための一連のプロセスを示しています。
