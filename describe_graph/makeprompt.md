# :star:makePromptの構成

このソースは、ユーザーとAIの対話を通じてプロンプトを作成・改善するためのワークフローを定義しています。以下に各部分の説明を行います。

## 構造の概要

1. **First_promptノード**:
   - `stringTemplateAgent`を使用して、AIがユーザーにプロンプトのテーマを尋ねるメッセージを表示します。

2. **nestedsuggestIdeaノード**:
   - `mapAgent`を使用して、ユーザーの入力に基づきプロンプトを生成するネストされたグラフを実行します。

3. **continueノード**:
   - ループを制御します。初期値は`true`で、ループの条件を更新します。

4. **informationノード**:
   - プロンプト作成に必要な情報を格納します。

5. **messagesノード**:
   - プロンプト作成のためのシステムメッセージを保持し、ユーザーへの指示を含みます。

6. **userInputノード**:
   - `textInputAgent`を使用して、ユーザーからの入力を促します。

7. **userMessageノード**:
   - ユーザーの入力メッセージをフィルタリングし、必要なプロパティを抽出します。

8. **appendedMessagesノード**:
   - ユーザーのメッセージをメッセージ配列に追加します。

9. **llmノード**:
   - OpenAI APIを呼び出し、ユーザーのメッセージとシステムメッセージに基づいて応答を生成します。

10. **reducerノード**:
    - LLMからの応答をメッセージ配列に追加します。

11. **outputノード**:
    - LLMからの応答をコンソールに出力します。

12. **meaning_llmノード**:
    - プロンプトをレビューし最適化するための別のOpenAIエージェントを使用します。

13. **argumentsParserノード**:
    - LLMからのツール呼び出しの引数をコピーします。

14. **loopCheckノード**:
    - ループを継続するか確認します。`stop`条件が満たされるまでループを続行します。

## フローの詳細

1. `First_prompt`ノードがユーザーにプロンプトのテーマを尋ねます。
2. `nestedsuggestIdea`ノードが、ユーザーの入力に基づいてプロンプト生成プロセスを開始します。
3. `userInput`ノードがユーザーからの入力を受け取り、`userMessage`ノードがそれをフィルタリングします。
4. `appendedMessages`ノードがユーザーのメッセージをメッセージ配列に追加します。
5. `llm`ノードがOpenAI APIを使用して応答を生成し、`reducer`ノードがその応答をメッセージ配列に追加します。
6. `output`ノードが応答をコンソールに表示します。
7. `meaning_llm`ノードがプロンプトをレビューし最適化します。
8. `loopCheck`ノードがプロセスを継続するか判断し、必要に応じてループを続行します。

このワークフローは、ユーザーとAIの対話を通じてプロンプトを段階的に改善する反復プロセスを実行します。ユーザーの入力とAIの提案を組み合わせ、満足のいくプロンプトが作成されるまで繰り返します。この過程で、プロンプトは継続的に最適化され、より効果的なものとなります。